import pandas as pd

_sdata_start = "2022-01-01"
_s_data_stop = "2022-01-14 12:00:00"

SPLIT_DATA = pd.date_range(_sdata_start, _s_data_stop, freq="30s")
NO_DATA_SCHEDULE = ["2022-1-10", "2022-2-20", "2022-3-30", "2022-4-10"]


DATA_CASES = (
    [
        (
            dict(schedule="68h", before="5d", after="1d"),
            [
                ("2022-01-02 20:00:00", "2022-01-07 20:00:00", "2022-01-08 20:00:00"),
                ("2022-01-05 16:00:00", "2022-01-10 16:00:00", "2022-01-11 16:00:00"),
                ("2022-01-08 12:00:00", "2022-01-13 12:00:00", "2022-01-14 12:00:00"),
            ],
        ),
        (
            dict(schedule="3d", before=1, after=1),
            [
                (_sdata_start, "2022-01-04", "2022-01-07"),
                ("2022-01-04", "2022-01-07", "2022-01-10"),
                ("2022-01-07", "2022-01-10", "2022-01-13"),
            ],
        ),
        (
            dict(schedule="3d", before=1, after=1, n_splits=2),
            [
                ("2022-01-04", "2022-01-07", "2022-01-10"),
                ("2022-01-07", "2022-01-10", "2022-01-13"),
            ],
        ),
        (
            dict(
                schedule=[
                    _sdata_start,
                    "2022-01-04",
                    "2022-01-07",
                    "2022-01-10",
                    "2022-01-13",
                    "2100",
                ],
                before=1,
                after=1,
            ),
            [
                (_sdata_start, "2022-01-04", "2022-01-07"),
                ("2022-01-04", "2022-01-07", "2022-01-10"),
                ("2022-01-07", "2022-01-10", "2022-01-13"),
            ],
        ),
        (
            dict(
                schedule=pd.DatetimeIndex(
                    [
                        _sdata_start,
                        "2022-01-04",
                        "2022-01-07",
                        "2022-01-10",
                        "2022-01-13",
                    ]
                ),
                before=1,
                after=1,
            ),
            [
                (_sdata_start, "2022-01-04", "2022-01-07"),
                ("2022-01-04", "2022-01-07", "2022-01-10"),
                ("2022-01-07", "2022-01-10", "2022-01-13"),
            ],
        ),
        (
            dict(schedule="3d", before="all", after=1),
            [
                (_sdata_start, "2022-01-04", "2022-01-07"),
                (_sdata_start, "2022-01-07", "2022-01-10"),
                (_sdata_start, "2022-01-10", "2022-01-13"),
            ],
        ),
        (
            dict(schedule="0 0 * * MON,FRI", before="all", after=2),
            [
                (_sdata_start, "2022-01-03", "2022-01-10"),
                (_sdata_start, "2022-01-07", "2022-01-14"),
            ],
        ),
        (
            dict(schedule="3d", before=2, after="all", expand_limits=False),
            [
                (_sdata_start, "2022-01-07", _s_data_stop),
                ("2022-01-04", "2022-01-10", _s_data_stop),
                ("2022-01-07", "2022-01-13", _s_data_stop),
            ],
        ),
        (
            dict(schedule="0 0 * * MON,FRI", before="5d"),
            [
                ("2022-01-02", "2022-01-07", "2022-01-10"),
                ("2022-01-05", "2022-01-10", "2022-01-14"),
            ],
        ),
        (
            dict(schedule="3d", before="3d", after="2d"),
            [
                ("2022-01-03", "2022-01-06", "2022-01-08"),
                ("2022-01-06", "2022-01-09", "2022-01-11"),
                ("2022-01-09", "2022-01-12", "2022-01-14"),
            ],
        ),
    ],
)


NO_DATA_CASES = [
    (
        1,
        [
            ("2022-01-05", "2022-01-10", "2022-02-20"),
            ("2022-02-15", "2022-02-20", "2022-03-30"),
            ("2022-03-25", "2022-03-30", "2022-04-10"),
        ],
    ),
    (
        2,
        [
            ("2022-01-05", "2022-01-10", "2022-03-30"),
            ("2022-02-15", "2022-02-20", "2022-04-10"),
        ],
    ),
    (
        "5d",
        [
            ("2022-01-05", "2022-01-10", "2022-01-15"),
            ("2022-02-15", "2022-02-20", "2022-02-25"),
            ("2022-03-25", "2022-03-30", "2022-04-04"),
            ("2022-04-05", "2022-04-10", "2022-04-15"),
        ],
    ),
]
